'use client';

import { useEffect, useState } from 'react';
import clsx from 'clsx';

import {
  FeedbackForm
} from './feedback-form';
import { usePath } from 'context/state';

enum FeedbackType {
  Negative,
  Positive
}

export const Feedback = () => {
  // Undefined means the user has not yet clicked a feedback button
  const [feedbackType, setFeedbackType] = useState<FeedbackType>();
  const path = usePath();
  const [isDarkMode, setIsDarkMode] = useState(false);
  useEffect(() => {
    const htmlElement = document.documentElement;
    setIsDarkMode(htmlElement.classList.contains('dark'));

    // Optionally, listen for changes to the dark mode class
    const observer = new MutationObserver(() => {
      setIsDarkMode(htmlElement.classList.contains('dark'));
    });

    observer.observe(htmlElement, { attributes: true, attributeFilter: ['class'] });

    return () => observer.disconnect();
  }, []);

  // Reset feedback type when the route changes
  useEffect(() => setFeedbackType(undefined), [path]);

  switch (feedbackType) {
    case FeedbackType.Negative:
      return (
        <FeedbackForm
          title="What went wrong?"
           
        />
      );
    case FeedbackType.Positive:
      return (
        <FeedbackForm
          title="What did you like?"
           
        />
      );
    default:
      return (
        <div id="Feedback" className={clsx('my-12 flex flex-col items-start')}>

          <div className="mt-4 flex gap-1 items-center">
            <h3 className="my-0 font-bold text-[15px] leading-4.5  text-base text-[#071219]]">
              Was this page helpful?
            </h3>
            <button
              aria-label="Thumbs up"
              className="hover:text-primary dark:text-slate-200 hover:dark:text-primary"
              onClick={() => setFeedbackType(FeedbackType.Positive)}
            >
              {isDarkMode ? <ThumbUp_inDarkMode /> : <ThumbUp/>}
            </button>
            <button
              aria-label="Thumbs down"
              className="hover:text-primary dark:text-slate-200 hover:dark:text-primary"
              onClick={() => setFeedbackType(FeedbackType.Negative)}
            >
               {isDarkMode ? <ThumbDown_inDarkMode /> : <ThumbDown/>}
            </button>
          </div>
        </div>
      );
  }
};

const ThumbDown = () => (
  <svg width="60"
    height="36"
    viewBox="0 0 60 36"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <rect x="0.5" y="0.5" width="59" height="35" rx="3.5" stroke="#CBD8E0" />
    <path d="M15.7042 10.333C17.7708 10.333 21.0208 11.0163 21.8208 11.583C22.0042 11.7163 22.1042 11.9163 22.1042 12.133V18.6497C22.1042 18.8497 22.0042 19.0497 21.8542 19.1663C21.8042 19.1997 20.6375 20.1164 19.4208 20.7997C17.9042 21.633 16.8542 22.7997 16.6042 23.533C16.3042 24.433 15.8708 25.6663 14.5042 25.6663C13.8542 25.6663 13.3208 25.2997 13.0375 24.6663C12.4708 23.3663 13.0708 21.5663 14.0708 20.1497C13.4042 19.9997 12.5708 19.783 12.0708 19.633C11.1542 19.3497 10.5542 18.683 10.4208 17.8663C10.3042 17.033 10.7208 16.183 11.6042 15.533C12.2542 13.783 13.3708 11.0163 14.1875 10.5663C14.5042 10.3997 15.0542 10.333 15.7042 10.333ZM20.7708 12.533C19.5042 11.9997 15.6042 11.4497 14.8708 11.733C14.4875 12.083 13.5042 14.3163 12.8208 16.1997C12.7708 16.333 12.6875 16.4497 12.5708 16.533C12.0208 16.8997 11.7375 17.333 11.7875 17.6997C11.8375 17.9997 12.1042 18.2497 12.5042 18.383C13.3375 18.6497 15.4042 19.0997 15.4375 19.0997C15.6708 19.1497 15.8542 19.3164 15.9375 19.5497C16.0042 19.783 15.9542 20.033 15.7875 20.1997C14.2875 21.8163 14.0208 23.4664 14.3042 24.133C14.3875 24.333 14.4875 24.333 14.5375 24.333C14.8708 24.333 15.0208 24.0997 15.3708 23.0997C15.7708 21.933 17.1542 20.533 18.8042 19.633C19.6042 19.1997 20.4042 18.6163 20.8042 18.3163V12.533H20.7708ZM23.4042 12.0663V18.7164C23.4042 19.3164 23.8875 19.7997 24.4875 19.7997C25.0875 19.7997 25.5708 19.3164 25.5708 18.7164V12.0663C25.5708 11.4663 25.0875 10.983 24.4875 10.983C23.9042 10.983 23.4042 11.483 23.4042 12.0663Z" fill="#52595E" />
    <path d="M33.008 23V13.13H34.632L39.994 19.948H39.616V13.13H41.646V23H40.022L34.674 16.182H35.038V23H33.008ZM46.8647 23.154C46.1087 23.154 45.4507 23.0047 44.8907 22.706C44.3401 22.398 43.9107 21.9687 43.6027 21.418C43.3041 20.8673 43.1547 20.2093 43.1547 19.444C43.1547 18.688 43.3041 18.0347 43.6027 17.484C43.9107 16.9333 44.3401 16.5087 44.8907 16.21C45.4507 15.9113 46.1087 15.762 46.8647 15.762C47.6207 15.762 48.2787 15.9113 48.8387 16.21C49.3987 16.5087 49.8281 16.9333 50.1267 17.484C50.4347 18.0347 50.5887 18.688 50.5887 19.444C50.5887 20.2093 50.4347 20.8673 50.1267 21.418C49.8281 21.9687 49.3987 22.398 48.8387 22.706C48.2787 23.0047 47.6207 23.154 46.8647 23.154ZM46.8647 21.558C47.3501 21.558 47.7327 21.3853 48.0127 21.04C48.3021 20.6947 48.4467 20.1627 48.4467 19.444C48.4467 18.7253 48.3021 18.198 48.0127 17.862C47.7327 17.526 47.3501 17.358 46.8647 17.358C46.3794 17.358 45.9921 17.526 45.7027 17.862C45.4227 18.198 45.2827 18.7253 45.2827 19.444C45.2827 20.1627 45.4227 20.6947 45.7027 21.04C45.9921 21.3853 46.3794 21.558 46.8647 21.558Z" fill="#52595E" />
  </svg>

);

const ThumbDown_inDarkMode = () => (
  <svg width="60"
    height="36"
    viewBox="0 0 60 36"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <rect x="0.5" y="0.5" width="59" height="35" rx="3.5" stroke="#CBD8E0" />
    <path d="M15.7042 10.333C17.7708 10.333 21.0208 11.0163 21.8208 11.583C22.0042 11.7163 22.1042 11.9163 22.1042 12.133V18.6497C22.1042 18.8497 22.0042 19.0497 21.8542 19.1663C21.8042 19.1997 20.6375 20.1164 19.4208 20.7997C17.9042 21.633 16.8542 22.7997 16.6042 23.533C16.3042 24.433 15.8708 25.6663 14.5042 25.6663C13.8542 25.6663 13.3208 25.2997 13.0375 24.6663C12.4708 23.3663 13.0708 21.5663 14.0708 20.1497C13.4042 19.9997 12.5708 19.783 12.0708 19.633C11.1542 19.3497 10.5542 18.683 10.4208 17.8663C10.3042 17.033 10.7208 16.183 11.6042 15.533C12.2542 13.783 13.3708 11.0163 14.1875 10.5663C14.5042 10.3997 15.0542 10.333 15.7042 10.333ZM20.7708 12.533C19.5042 11.9997 15.6042 11.4497 14.8708 11.733C14.4875 12.083 13.5042 14.3163 12.8208 16.1997C12.7708 16.333 12.6875 16.4497 12.5708 16.533C12.0208 16.8997 11.7375 17.333 11.7875 17.6997C11.8375 17.9997 12.1042 18.2497 12.5042 18.383C13.3375 18.6497 15.4042 19.0997 15.4375 19.0997C15.6708 19.1497 15.8542 19.3164 15.9375 19.5497C16.0042 19.783 15.9542 20.033 15.7875 20.1997C14.2875 21.8163 14.0208 23.4664 14.3042 24.133C14.3875 24.333 14.4875 24.333 14.5375 24.333C14.8708 24.333 15.0208 24.0997 15.3708 23.0997C15.7708 21.933 17.1542 20.533 18.8042 19.633C19.6042 19.1997 20.4042 18.6163 20.8042 18.3163V12.533H20.7708ZM23.4042 12.0663V18.7164C23.4042 19.3164 23.8875 19.7997 24.4875 19.7997C25.0875 19.7997 25.5708 19.3164 25.5708 18.7164V12.0663C25.5708 11.4663 25.0875 10.983 24.4875 10.983C23.9042 10.983 23.4042 11.483 23.4042 12.0663Z" fill="#fff" />
    <path d="M33.008 23V13.13H34.632L39.994 19.948H39.616V13.13H41.646V23H40.022L34.674 16.182H35.038V23H33.008ZM46.8647 23.154C46.1087 23.154 45.4507 23.0047 44.8907 22.706C44.3401 22.398 43.9107 21.9687 43.6027 21.418C43.3041 20.8673 43.1547 20.2093 43.1547 19.444C43.1547 18.688 43.3041 18.0347 43.6027 17.484C43.9107 16.9333 44.3401 16.5087 44.8907 16.21C45.4507 15.9113 46.1087 15.762 46.8647 15.762C47.6207 15.762 48.2787 15.9113 48.8387 16.21C49.3987 16.5087 49.8281 16.9333 50.1267 17.484C50.4347 18.0347 50.5887 18.688 50.5887 19.444C50.5887 20.2093 50.4347 20.8673 50.1267 21.418C49.8281 21.9687 49.3987 22.398 48.8387 22.706C48.2787 23.0047 47.6207 23.154 46.8647 23.154ZM46.8647 21.558C47.3501 21.558 47.7327 21.3853 48.0127 21.04C48.3021 20.6947 48.4467 20.1627 48.4467 19.444C48.4467 18.7253 48.3021 18.198 48.0127 17.862C47.7327 17.526 47.3501 17.358 46.8647 17.358C46.3794 17.358 45.9921 17.526 45.7027 17.862C45.4227 18.198 45.2827 18.7253 45.2827 19.444C45.2827 20.1627 45.4227 20.6947 45.7027 21.04C45.9921 21.3853 46.3794 21.558 46.8647 21.558Z" fill="#fff" />
  </svg>

);

const ThumbUp = () => (
  <svg width="63"
    height="36"
    viewBox="0 0 63 36"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <rect x="0.5" y="0.5" width="62" height="35" rx="3.5" stroke="#CBD8E0" />
    <path d="M20.3042 25.6663C18.2375 25.6663 14.9875 24.983 14.1875 24.4163C14.0042 24.283 13.9042 24.083 13.9042 23.8663V17.3497C13.9042 17.1497 14.0042 16.9497 14.1542 16.833C14.2042 16.7997 15.3708 15.883 16.5875 15.1997C18.1042 14.3663 19.1542 13.1997 19.4042 12.4663C19.7042 11.5663 20.1375 10.333 21.5042 10.333C22.1542 10.333 22.6875 10.6997 22.9708 11.333C23.5375 12.633 22.9375 14.433 21.9375 15.8497C22.6042 15.9997 23.4375 16.2163 23.9375 16.3663C24.8542 16.6497 25.4542 17.3164 25.5875 18.133C25.7042 18.9664 25.2875 19.8164 24.4042 20.4664C23.7542 22.2164 22.6375 24.983 21.8208 25.433C21.5042 25.5997 20.9542 25.6663 20.3042 25.6663ZM15.2375 23.4664C16.5042 23.9997 20.4042 24.5497 21.1375 24.2663C21.5208 23.9163 22.5042 21.683 23.1875 19.7997C23.2375 19.6664 23.3208 19.5497 23.4375 19.4664C23.9875 19.0997 24.2708 18.6664 24.2208 18.2997C24.1708 17.9997 23.9042 17.7497 23.5042 17.6163C22.6708 17.3497 20.6042 16.8997 20.5708 16.8997C20.3375 16.8497 20.1542 16.683 20.0708 16.4497C19.9875 16.2163 20.0542 15.9664 20.2208 15.7997C21.7208 14.183 21.9875 12.533 21.7042 11.8663C21.6208 11.6663 21.5208 11.6663 21.4708 11.6663C21.1375 11.6663 20.9875 11.8997 20.6375 12.8997C20.2375 14.0663 18.8542 15.4663 17.2042 16.3663C16.4042 16.7997 15.6042 17.383 15.2042 17.683V23.4664H15.2375ZM12.6042 23.933V17.283C12.6042 16.683 12.1208 16.1997 11.5208 16.1997C10.9208 16.1997 10.4375 16.683 10.4375 17.283V23.933C10.4375 24.533 10.9208 25.0163 11.5208 25.0163C12.1042 25.0163 12.6042 24.5163 12.6042 23.933Z" fill="#52595E" />
    <path d="M35.402 23V18.31L35.85 19.556L31.524 13.13H34.044L36.76 17.358H36.312L39.028 13.13H41.464L37.152 19.556L37.586 18.31V23H35.402ZM44.231 23.154C42.999 23.154 42.0376 22.8227 41.347 22.16C40.6563 21.4973 40.311 20.5967 40.311 19.458C40.311 18.7207 40.4556 18.0767 40.745 17.526C41.0436 16.9753 41.4543 16.546 41.977 16.238C42.509 15.9207 43.1296 15.762 43.839 15.762C44.539 15.762 45.1223 15.9113 45.589 16.21C46.065 16.5087 46.4196 16.9287 46.653 17.47C46.8956 18.002 47.017 18.6227 47.017 19.332V19.822H42.047V18.772H45.477L45.239 18.968C45.239 18.38 45.1176 17.9367 44.875 17.638C44.6416 17.33 44.301 17.176 43.853 17.176C43.3583 17.176 42.9756 17.358 42.705 17.722C42.4436 18.086 42.313 18.6087 42.313 19.29V19.514C42.313 20.2047 42.481 20.718 42.817 21.054C43.1623 21.39 43.657 21.558 44.301 21.558C44.6836 21.558 45.043 21.5113 45.379 21.418C45.7243 21.3153 46.051 21.1567 46.359 20.942L46.947 22.342C46.5923 22.6033 46.1816 22.804 45.715 22.944C45.2576 23.084 44.763 23.154 44.231 23.154ZM50.9762 23.154C50.3416 23.154 49.7629 23.084 49.2402 22.944C48.7176 22.804 48.2742 22.608 47.9102 22.356L48.4562 20.956C48.8202 21.18 49.2216 21.3573 49.6602 21.488C50.1082 21.6187 50.5516 21.684 50.9902 21.684C51.4009 21.684 51.7042 21.6187 51.9002 21.488C52.0962 21.3573 52.1942 21.18 52.1942 20.956C52.1942 20.7693 52.1289 20.6247 51.9982 20.522C51.8769 20.4193 51.6856 20.3447 51.4242 20.298L49.9822 20.032C49.3756 19.9107 48.9136 19.6867 48.5962 19.36C48.2789 19.0333 48.1202 18.6087 48.1202 18.086C48.1202 17.6287 48.2416 17.2273 48.4842 16.882C48.7362 16.5273 49.0956 16.252 49.5622 16.056C50.0289 15.86 50.5749 15.762 51.2002 15.762C51.7322 15.762 52.2362 15.8273 52.7122 15.958C53.1882 16.0887 53.5942 16.2893 53.9302 16.56L53.3562 17.918C53.0669 17.7033 52.7309 17.5307 52.3482 17.4C51.9749 17.2693 51.6156 17.204 51.2702 17.204C50.8222 17.204 50.5002 17.2787 50.3042 17.428C50.1082 17.568 50.0102 17.75 50.0102 17.974C50.0102 18.142 50.0662 18.282 50.1782 18.394C50.2996 18.506 50.4816 18.59 50.7242 18.646L52.1802 18.912C52.8056 19.024 53.2816 19.234 53.6082 19.542C53.9349 19.85 54.0982 20.2747 54.0982 20.816C54.0982 21.3107 53.9676 21.7307 53.7062 22.076C53.4449 22.4213 53.0762 22.6873 52.6002 22.874C52.1336 23.0607 51.5922 23.154 50.9762 23.154Z" fill="#52595E" />
  </svg>
);

const ThumbUp_inDarkMode = () => (
  <svg width="63"
    height="36"
    viewBox="0 0 63 36"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <rect x="0.5" y="0.5" width="62" height="35" rx="3.5" stroke="#CBD8E0" />
    <path d="M20.3042 25.6663C18.2375 25.6663 14.9875 24.983 14.1875 24.4163C14.0042 24.283 13.9042 24.083 13.9042 23.8663V17.3497C13.9042 17.1497 14.0042 16.9497 14.1542 16.833C14.2042 16.7997 15.3708 15.883 16.5875 15.1997C18.1042 14.3663 19.1542 13.1997 19.4042 12.4663C19.7042 11.5663 20.1375 10.333 21.5042 10.333C22.1542 10.333 22.6875 10.6997 22.9708 11.333C23.5375 12.633 22.9375 14.433 21.9375 15.8497C22.6042 15.9997 23.4375 16.2163 23.9375 16.3663C24.8542 16.6497 25.4542 17.3164 25.5875 18.133C25.7042 18.9664 25.2875 19.8164 24.4042 20.4664C23.7542 22.2164 22.6375 24.983 21.8208 25.433C21.5042 25.5997 20.9542 25.6663 20.3042 25.6663ZM15.2375 23.4664C16.5042 23.9997 20.4042 24.5497 21.1375 24.2663C21.5208 23.9163 22.5042 21.683 23.1875 19.7997C23.2375 19.6664 23.3208 19.5497 23.4375 19.4664C23.9875 19.0997 24.2708 18.6664 24.2208 18.2997C24.1708 17.9997 23.9042 17.7497 23.5042 17.6163C22.6708 17.3497 20.6042 16.8997 20.5708 16.8997C20.3375 16.8497 20.1542 16.683 20.0708 16.4497C19.9875 16.2163 20.0542 15.9664 20.2208 15.7997C21.7208 14.183 21.9875 12.533 21.7042 11.8663C21.6208 11.6663 21.5208 11.6663 21.4708 11.6663C21.1375 11.6663 20.9875 11.8997 20.6375 12.8997C20.2375 14.0663 18.8542 15.4663 17.2042 16.3663C16.4042 16.7997 15.6042 17.383 15.2042 17.683V23.4664H15.2375ZM12.6042 23.933V17.283C12.6042 16.683 12.1208 16.1997 11.5208 16.1997C10.9208 16.1997 10.4375 16.683 10.4375 17.283V23.933C10.4375 24.533 10.9208 25.0163 11.5208 25.0163C12.1042 25.0163 12.6042 24.5163 12.6042 23.933Z" fill="#fff" />
    <path d="M35.402 23V18.31L35.85 19.556L31.524 13.13H34.044L36.76 17.358H36.312L39.028 13.13H41.464L37.152 19.556L37.586 18.31V23H35.402ZM44.231 23.154C42.999 23.154 42.0376 22.8227 41.347 22.16C40.6563 21.4973 40.311 20.5967 40.311 19.458C40.311 18.7207 40.4556 18.0767 40.745 17.526C41.0436 16.9753 41.4543 16.546 41.977 16.238C42.509 15.9207 43.1296 15.762 43.839 15.762C44.539 15.762 45.1223 15.9113 45.589 16.21C46.065 16.5087 46.4196 16.9287 46.653 17.47C46.8956 18.002 47.017 18.6227 47.017 19.332V19.822H42.047V18.772H45.477L45.239 18.968C45.239 18.38 45.1176 17.9367 44.875 17.638C44.6416 17.33 44.301 17.176 43.853 17.176C43.3583 17.176 42.9756 17.358 42.705 17.722C42.4436 18.086 42.313 18.6087 42.313 19.29V19.514C42.313 20.2047 42.481 20.718 42.817 21.054C43.1623 21.39 43.657 21.558 44.301 21.558C44.6836 21.558 45.043 21.5113 45.379 21.418C45.7243 21.3153 46.051 21.1567 46.359 20.942L46.947 22.342C46.5923 22.6033 46.1816 22.804 45.715 22.944C45.2576 23.084 44.763 23.154 44.231 23.154ZM50.9762 23.154C50.3416 23.154 49.7629 23.084 49.2402 22.944C48.7176 22.804 48.2742 22.608 47.9102 22.356L48.4562 20.956C48.8202 21.18 49.2216 21.3573 49.6602 21.488C50.1082 21.6187 50.5516 21.684 50.9902 21.684C51.4009 21.684 51.7042 21.6187 51.9002 21.488C52.0962 21.3573 52.1942 21.18 52.1942 20.956C52.1942 20.7693 52.1289 20.6247 51.9982 20.522C51.8769 20.4193 51.6856 20.3447 51.4242 20.298L49.9822 20.032C49.3756 19.9107 48.9136 19.6867 48.5962 19.36C48.2789 19.0333 48.1202 18.6087 48.1202 18.086C48.1202 17.6287 48.2416 17.2273 48.4842 16.882C48.7362 16.5273 49.0956 16.252 49.5622 16.056C50.0289 15.86 50.5749 15.762 51.2002 15.762C51.7322 15.762 52.2362 15.8273 52.7122 15.958C53.1882 16.0887 53.5942 16.2893 53.9302 16.56L53.3562 17.918C53.0669 17.7033 52.7309 17.5307 52.3482 17.4C51.9749 17.2693 51.6156 17.204 51.2702 17.204C50.8222 17.204 50.5002 17.2787 50.3042 17.428C50.1082 17.568 50.0102 17.75 50.0102 17.974C50.0102 18.142 50.0662 18.282 50.1782 18.394C50.2996 18.506 50.4816 18.59 50.7242 18.646L52.1802 18.912C52.8056 19.024 53.2816 19.234 53.6082 19.542C53.9349 19.85 54.0982 20.2747 54.0982 20.816C54.0982 21.3107 53.9676 21.7307 53.7062 22.076C53.4449 22.4213 53.0762 22.6873 52.6002 22.874C52.1336 23.0607 51.5922 23.154 50.9762 23.154Z" fill="#fff" />
  </svg>
);
